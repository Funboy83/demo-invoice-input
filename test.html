<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Printable Invoice Template</title>
    <!-- Tailwind CSS CDN for styling -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Google Fonts - Inter -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700;800&display=swap" rel="stylesheet">
    <!-- React & ReactDOM CDNs -->
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <!-- Babel CDN for JSX transformation in the browser (for development/simple demo only) -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
</head>
<body class="font-sans">
    <div id="root"></div>

    <script type="text/babel">
        // Main App component for the Invoice Template
        function App() {
            // State for general invoice details
            const [invoiceDetails, setInvoiceDetails] = React.useState({
                invoiceNumber: 'INV-001',
                date: new Date().toISOString().slice(0, 10), // Current date in YYYY-MM-DD format
                customerName: '',
                notes: ''
            });

            // State for the line items in the invoice
            const [items, setItems] = React.useState([]);

            // State for the new item being added
            const [newItem, setNewItem] = React.useState({
                name: '',
                quantity: 1,
                unitPrice: 0.00
            });

            // Ref to the invoice section for printing
            const invoiceRef = React.useRef();

            // Calculate the total amount of all items
            const subtotal = items.reduce((sum, item) => sum + (item.quantity * item.unitPrice), 0);

            // Handle changes in invoice detail fields
            const handleInvoiceDetailsChange = (e) => {
                const { name, value } = e.target;
                setInvoiceDetails(prevDetails => ({
                    ...prevDetails,
                    [name]: value
                }));
            };

            // Handle changes in new item input fields
            const handleNewItemChange = (e) => {
                const { name, value } = e.target;
                setNewItem(prevItem => ({
                    ...prevItem,
                    // For quantity and unitPrice, parse as float; otherwise, use the raw value.
                    // Ensure unitPrice can be an empty string for easier input/deletion.
                    [name]: (name === 'quantity' || name === 'unitPrice') ?
                            (value === '' ? '' : parseFloat(value) || 0) : value
                }));
            };

            // Add a new item to the invoice
            const handleAddItem = (e) => {
                e.preventDefault(); // Prevent form submission
                // Ensure all required fields for newItem are filled and valid
                if (newItem.name && newItem.quantity > 0 && typeof newItem.unitPrice === 'number' && newItem.unitPrice >= 0) {
                    setItems(prevItems => [...prevItems, { ...newItem }]);
                    setNewItem({ name: '', quantity: 1, unitPrice: 0.00 }); // Reset new item fields
                } else {
                    // Use a custom message box or alert for user feedback
                    // Removed alert() as per instructions
                    console.error("Please fill in all item details correctly (Name, Quantity > 0, Unit Price >= 0).");
                    // You might want to implement a custom modal or message display here instead of console.error
                }
            };

            // Remove an item from the invoice by index
            const handleRemoveItem = (index) => {
                setItems(prevItems => prevItems.filter((_, i) => i !== index));
            };

            // Handle the print action
            const handlePrint = () => {
                window.print();
            };

            // Ensure initial focus on the first input field
            React.useEffect(() => {
                document.getElementById('invoiceNumber').focus();
            }, []);

            return (
                <div className="min-h-screen bg-gray-100 p-4 font-sans text-gray-800 flex flex-col items-center">
                    {/* Input Form Section */}
                    <div className="w-full max-w-4xl bg-white rounded-lg shadow-md p-6 mb-8 print:hidden">
                        <h1 className="text-3xl font-bold text-center mb-6 text-gray-700">Create New Invoice</h1>

                        {/* Invoice Header Details Input */}
                        <div className="grid grid-cols-1 md:grid-cols-2 gap-4 mb-6">
                            <div className="flex flex-col">
                                <label htmlFor="invoiceNumber" className="text-sm font-medium text-gray-600 mb-1">Invoice Number:</label>
                                <input
                                    type="text"
                                    id="invoiceNumber"
                                    name="invoiceNumber"
                                    value={invoiceDetails.invoiceNumber}
                                    onChange={handleInvoiceDetailsChange}
                                    className="p-2 border border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500"
                                    placeholder="e.g., INV-001"
                                />
                            </div>
                            <div className="flex flex-col">
                                <label htmlFor="date" className="text-sm font-medium text-gray-600 mb-1">Date:</label>
                                <input
                                    type="date"
                                    id="date"
                                    name="date"
                                    value={invoiceDetails.date}
                                    onChange={handleInvoiceDetailsChange}
                                    className="p-2 border border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500"
                                />
                            </div>
                            <div className="flex flex-col md:col-span-2">
                                <label htmlFor="customerName" className="text-sm font-medium text-gray-600 mb-1">To (Customer Name):</label>
                                <input
                                    type="text"
                                    id="customerName"
                                    name="customerName"
                                    value={invoiceDetails.customerName}
                                    onChange={handleInvoiceDetailsChange}
                                    className="p-2 border border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500"
                                    placeholder="e.g., John Doe"
                                />
                            </div>
                            <div className="flex flex-col md:col-span-2">
                                <label htmlFor="notes" className="text-sm font-medium text-gray-600 mb-1">Notes:</label>
                                <textarea
                                    id="notes"
                                    name="notes"
                                    value={invoiceDetails.notes}
                                    onChange={handleInvoiceDetailsChange}
                                    rows="3"
                                    className="p-2 border border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500"
                                    placeholder="Add any specific notes for the invoice here..."
                                ></textarea>
                            </div>
                        </div>

                        {/* Add New Item Form */}
                        <h2 className="text-xl font-semibold text-gray-700 mb-4">Add Item</h2>
                        <form onSubmit={handleAddItem} className="grid grid-cols-1 md:grid-cols-4 gap-4 items-end mb-6">
                            <div className="flex flex-col">
                                <label htmlFor="newItemName" className="text-sm font-medium text-gray-600 mb-1">Item Name:</label>
                                <input
                                    type="text"
                                    id="newItemName"
                                    name="name"
                                    value={newItem.name}
                                    onChange={handleNewItemChange}
                                    className="p-2 border border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500"
                                    placeholder="Product/Service"
                                    required
                                />
                            </div>
                            <div className="flex flex-col">
                                <label htmlFor="newItemQuantity" className="text-sm font-medium text-gray-600 mb-1">Quantity:</label>
                                <input
                                    type="number"
                                    id="newItemQuantity"
                                    name="quantity"
                                    value={newItem.quantity}
                                    onChange={handleNewItemChange}
                                    min="1"
                                    className="p-2 border border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500"
                                    required
                                />
                            </div>
                            <div className="flex flex-col">
                                <label htmlFor="newItemUnitPrice" className="text-sm font-medium text-gray-600 mb-1">Unit Price:</label>
                                <input
                                    type="number"
                                    id="newItemUnitPrice"
                                    name="unitPrice"
                                    value={newItem.unitPrice}
                                    onChange={handleNewItemChange}
                                    step="0.01"
                                    min="0"
                                    className="p-2 border border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500"
                                    required
                                />
                            </div>
                            <button
                                type="submit"
                                className="w-full bg-blue-600 text-white py-2 px-4 rounded-md hover:bg-blue-700 transition-colors duration-200 shadow-md"
                            >
                                Add Item
                            </button>
                        </form>
                    </div>

                    {/* Printable Invoice Display Section */}
                    <div
                        ref={invoiceRef}
                        className="w-full max-w-4xl bg-white rounded-lg shadow-lg p-8 print:shadow-none print:p-0 print:border print:border-gray-300"
                        style={{ fontFamily: 'Inter, sans-serif' }}
                    >
                        <div className="flex justify-between items-center mb-8 pb-4 border-b border-gray-200">
                            <h1 className="text-4xl font-extrabold text-gray-900">INVOICE</h1>
                            <div className="text-right">
                                <p className="text-sm text-gray-600">Invoice No: <span className="font-semibold text-gray-800">{invoiceDetails.invoiceNumber}</span></p>
                                <p className="text-sm text-gray-600">Date: <span className="font-semibold text-gray-800">{invoiceDetails.date}</span></p>
                            </div>
                        </div>

                        <div className="mb-8">
                            <h2 className="text-lg font-semibold text-gray-700 mb-2">To:</h2>
                            <p className="text-gray-800 text-base">{invoiceDetails.customerName || 'Customer Name'}</p>
                        </div>

                        {/* Invoice Items Table */}
                        <div className="overflow-x-auto mb-8">
                            <table className="min-w-full bg-white border border-gray-300 rounded-md overflow-hidden">
                                <thead>
                                    <tr className="bg-gray-100 border-b border-gray-300">
                                        <th className="py-3 px-4 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider">Quantity</th>
                                        <th className="py-3 px-4 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider">Description</th>
                                        <th className="py-3 px-4 text-right text-xs font-semibold text-gray-600 uppercase tracking-wider">Unit Price</th>
                                        <th className="py-3 px-4 text-right text-xs font-semibold text-gray-600 uppercase tracking-wider">Amount</th>
                                        <th className="py-3 px-4 text-center text-xs font-semibold text-gray-600 uppercase tracking-wider print:hidden">Actions</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    {items.length === 0 ? (
                                        <tr>
                                            <td colSpan="5" className="py-4 px-4 text-center text-gray-500 italic">No items added yet.</td>
                                        </tr>
                                    ) : (
                                        items.map((item, index) => (
                                            <tr key={index} className="border-b border-gray-200 last:border-b-0">
                                                <td className="py-3 px-4 text-sm text-gray-800">{item.quantity}</td>
                                                <td className="py-3 px-4 text-sm text-gray-800">{item.name}</td>
                                                <td className="py-3 px-4 text-right text-sm text-gray-800">${item.unitPrice.toFixed(2)}</td>
                                                <td className="py-3 px-4 text-right text-sm text-gray-800">${(item.quantity * item.unitPrice).toFixed(2)}</td>
                                                <td className="py-3 px-4 text-center print:hidden">
                                                    <button
                                                        onClick={() => handleRemoveItem(index)}
                                                        className="text-red-600 hover:text-red-800 transition-colors duration-200 text-sm font-medium"
                                                    >
                                                        Remove
                                                    </button>
                                                </td>
                                            </tr>
                                        ))
                                    )}
                                </tbody>
                            </table>
                        </div>

                        {/* Notes and Total Section */}
                        <div className="flex justify-between items-start">
                            <div className="w-1/2 pr-4">
                                <h2 className="text-lg font-semibold text-gray-700 mb-2">Notes:</h2>
                                <p className="text-gray-800 text-sm italic">{invoiceDetails.notes || 'No specific notes for this invoice.'}</p>
                            </div>
                            <div className="w-1/2 pl-4 text-right">
                                <p className="text-lg font-bold text-gray-800">TOTAL: <span className="text-blue-700">${subtotal.toFixed(2)}</span></p>
                            </div>
                        </div>
                    </div>

                    {/* Print Button */}
                    <div className="w-full max-w-4xl mt-8 flex justify-center print:hidden">
                        <button
                            onClick={handlePrint}
                            className="bg-green-600 text-white py-3 px-8 rounded-md hover:bg-green-700 transition-colors duration-200 shadow-lg text-lg font-semibold"
                        >
                            Print Invoice
                        </button>
                    </div>

                    {/* Print Styles for the invoice */}
                    <style dangerouslySetInnerHTML={{__html: `
                        @media print {
                            body * {
                                visibility: hidden;
                            }
                            #root > div:first-child { /* Targets the input form section */
                                display: none;
                            }
                            #root > div:last-child { /* Targets the print button div */
                                display: none;
                            }
                            .print\\:hidden { /* Use escaped colon for Tailwind classes in CSS */
                                display: none !important;
                            }
                            .print\\:shadow-none {
                                box-shadow: none !important;
                            }
                            .print\\:p-0 {
                                padding: 0 !important;
                            }
                            .print\\:border {
                                border: 1px solid #ccc !important;
                            }
                            /* Show only the invoice display section for printing */
                            .invoice-display-section, .invoice-display-section * {
                                visibility: visible;
                            }
                            /* Ensure specific elements always show */
                            .w-full.max-w-4xl.bg-white.rounded-lg.shadow-lg.p-8,
                            .w-full.max-w-4xl.bg-white.rounded-lg.shadow-lg.p-8 * {
                                visibility: visible;
                            }
                            /* Apply styles to the main printable div */
                            .w-full.max-w-4xl.bg-white.rounded-lg.shadow-lg.p-8 {
                                position: absolute;
                                left: 0;
                                top: 0;
                                width: 100%;
                                max-width: none;
                                margin: 0;
                                padding: 20px;
                                box-sizing: border-box;
                            }
                            table {
                              width: 100%;
                            }
                        }
                    `}} />
                </div>
            );
        }

        // Render the App component into the 'root' div
        ReactDOM.render(<App />, document.getElementById('root'));
    </script>
</body>
</html>
